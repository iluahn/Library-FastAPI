### FastAPI

В проекте реализован API для простой библиотеки (пользователи-читатели и связанные с ними книги) с использованием FastAPI.  
Для работы с базой данных используется SQLAlchemy. Для тестирования и отладки использовалась автодокументация Swagger UI от FastAPI.

---

Модель sqlalchemy **пользователя** имеет поля:
- id (целочисленне значение, являющееся PrimaryKey);
- name (строка);
- email (строка с UniqueConstraint'ом).
Также в данной модели используется relationship для связи с моделью книги.  



Модель sqlalchemy **книги** имеет поля:
- id (целочисленне значение, являющееся PrimaryKey);
- name (строка с UniqueConstraint'ом);
- description (строка, опциональный параметр);
- user_id (целочисленне значение, указывающее на id пользователя-владельца книги через ForeignKey).

---
Как для пользователя, так и для книги, реализованы все CRUD-операции.  
Создание книги возможно только "внутри пользователя" - эндпоинт POST-метода создания книги содержит path-параметр с user_id, который передается при создании книги и "привязывает" её к конкретному (существующему) пользователю.  
Содержатся проверки на "такая сущность уже существует" (для POST) и "сущность с таким id не найдена" (для остальных методов).


Для корректной работы каскадного удаления книг при удалении пользователя, к которому эти книги привязаны, в main дополнительно прописан следующий блок:
```
# включаем foreign-keys, чтобы работало каскадное удаление
@event.listens_for(engine, "connect")
def _set_sqlite_pragma(dbapi_connection, connection_record):
    if(isinstance(dbapi_connection, SQLite3Connection)):
        cursor = dbapi_connection.cursor()
        cursor.execute("PRAGMA foreign_keys=ON;")
        cursor.close()
```
